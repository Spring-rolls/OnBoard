<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/1599d6604b.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/styles/ballNoticfication.css" />

</head>
<body>
<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="/">Home page</a>
        </div>
        <ul class="nav navbar-nav">
            <li ><a th:if="${authUser}" th:href="${'/profile'}" >profile</a></li>
            <li ><a th:if="${authUser}" th:href="${'/event'}" >Create event</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li sec:authorize="!isAuthenticated()"><a href="/signup" ><span class="glyphicon glyphicon-user"></span> Sign Up Business</a></li>
            <li sec:authorize="!isAuthenticated()"><a href="/signupNormal" ><span class="glyphicon glyphicon-user"></span> Sign Up Normal</a></li>
            <li sec:authorize="!isAuthenticated()"><a href="/login"  ><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
            <div class="ball">
                <div class = "icons">
                    <div class = "notification">
                        <div class = "notBtn" >
                            <i class="fas fa-bell"></i>
                            <div class = "box">
                                <div class = "display">
                                    <div class = "cont">
                                        <div th:each="event:${authUser.getEventList()}">
                                            <div class = "sec new" th:each="userJoin:${event.getApplicationUserList()}">
                                                <div class = "profCont">
                                                    <img class = "profile" th:src="${userJoin.getImage()}" >
                                                </div>
                                                <div class = "txt"> <p th:text="${userJoin.getFirstName()+ ' has joined to '+event.getGameName()  + ' event' }" ></p></div>
                                                <div class = "txt sub">11/7 - 2:30 pm</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <li sec:authorize="isAuthenticated()"><a href="/perform_logout"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
        </ul>
    </div>
</nav>
<div th:if="${authUser}">
<img th:src="${authUser.getImage()}" class="img">
<p th:text="' firstName: ' +${authUser.getFirstName()} +' '+${authUser.getLastName()}"> </p>
<p th:text="' type: ' + ${authUser.getUserType()}"> </p>
<p th:if="${authUser.getUserType() == 'business'}" th:text="${authUser.getLocation()}"> </p>
<p th:if="${authUser.getUserType() == 'business'}" th:text="${authUser.getPlaceName()}"> </p>
<p th:if="${authUser.getUserType() == 'business'}" th:text="${authUser.getWorkingHour()}"> </p>
</div>
<main>
    <h1>Host events</h1>
    <div th:if="${authUser.getUserType() == 'normal'}">
        <div th:each="event:${authUser.getEventList()}">
            <p th:text="'gameName '+${event.getGameName()}"></p>
            <p th:text="'NumberOfPlayer '+${event.getNumberOfPlayer()}"></p>
            <p th:text="'DateTime '+${event.getDateTime()}"></p>
            <p th:text="'Place '+${event.getPlace()}"></p>
            <p th:text="${'joined player '+(event.getApplicationUserList().size()+1)}"> </p>

            <div th:each="userJoin:${event.getApplicationUserList()}">
                <p th:text="${userJoin.getFirstName()}"></p>
            </div>
            <div th:if="${(event.getApplicationUserList().size()+1)>=event.getNumberOfPlayer()}">
            <h2> the event is ready </h2>
            </div>
            <a href="#" class="btn btn-danger" th:href="@{/deleted/{id}(id=${event.getId()})}">delete</a>
            <a href="#" class="btn btn-primary" th:href="@{/updatefromprofile/{id}(id=${event.getId()})}">update</a>

        </div>
    </div>
    <div th:if="${authUser.getUserType() == 'business'}">
        <div th:each="event:${authUser.getEventList()}">
            <p th:text="'gameName '+${event.getGameName()}"></p>
            <p th:text="'Description '+${event.getDescription()}"></p>
            <p th:text="'DateTime '+${event.getDateTime()}"></p>
            <p th:text="'Place '+${event.getPlace()}"></p>
            <p th:text="${'joined player '+(event.getApplicationUserList().size())}"> </p>
            <div th:each="userJoin:${event.getApplicationUserList()}">
                <p th:text="${userJoin.getFirstName()}"></p>
            </div>
            <a  href="#" class="btn btn-primary" th:href="@{/updatefromprofile/{id}(id=${event.getId()})}">update</a>
            <a href="#" class="btn btn-danger" th:href="@{/deleted/{id}(id=${event.getId()})}">delete</a>
        </div>
    </div>
    <h1 th:if="${authUser.getUserType() == 'normal'}">join event</h1>
    <div th:each="event:${authUser.getEvents()}">
        <div th:if="${event.getApplicationUser().getUserType() == 'normal'}">
            <img th:src="${event.getApplicationUser().getImage()}" class="img">
            <p th:text="'Host Name ...!: '+${event.getApplicationUser().getFirstName()}"></p>
            <p th:text="'gameName '+${event.getGameName()}"></p>
            <p th:text="'NumberOfPlayer '+${event.getNumberOfPlayer()}"></p>
            <p th:text="'DateTime '+${event.getDateTime()}"></p>
            <p th:text="'Place '+${event.getPlace()}"></p>
            <div th:each="userJoin:${event.getApplicationUserList()}">
                <p th:text="${userJoin.getFirstName()}"></p>
            </div>
            <div th:if="${authUser}">
                <p th:text="${'joined player '+(event.getApplicationUserList().size()+1)}"> </p>
                <div th:if="!${event.getApplicationUser() == authUser}">
                    <a th:if="${authUser.getEvents().contains(event)}" href="#" class="btn btn-primary" th:href="@{/unjoins/{id}(id=${event.getId()})}">unjoin</a>
                </div>
            </div>
        </div>
        <div th:if="${event.getApplicationUser().getUserType() == 'business'}">
            <img th:src="${event.getApplicationUser().getImage()}" class="img">
            <p th:text="'Host Name ...!: '+${event.getApplicationUser().getFirstName()}"></p>
            <p th:text="'gameName '+${event.getGameName()}"></p>
            <p th:text="'Description '+${event.getDescription()}"></p>
            <p th:text="'DateTime '+${event.getDateTime()}"></p>
            <p th:text="'Place '+${event.getPlace()}"></p>
            <div th:each="userJoin:${event.getApplicationUserList()}">
                <p th:text="${userJoin.getFirstName()}"></p>
            </div>
            <div th:if="${authUser}">
                <p th:text="${'joined player '+(event.getApplicationUserList().size())}"> </p>
                <div th:if="!${event.getApplicationUser() == authUser}">
                    <a th:if="${authUser.getEvents().contains(event)}" href="#" class="btn btn-primary" th:href="@{/unjoins/{id}(id=${event.getId()})}">uninterested</a>
                </div>
            </div>
        </div>
    </div>
<!--    <div id="notification">-->
<!--        <div th:each="event:${authUser.getEventList()}">-->
<!--            <div th:each="userJoin:${event.getApplicationUserList()}">-->
<!--                <p th:text="${userJoin.getFirstName()+ ' has joined to '+event.getGameName()  + ' event' }" ></p>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

</main>

</body>
</html>